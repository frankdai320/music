{% load tz %}
{% timezone "America/Los_Angeles" %}
Submit by {{name}} at {{ date|date:"D d M Y" }} {{ date|time:"H:i" }}.
<br>

<iframe id="player" src="http://www.youtube.com/embed/{{url}}?enablejsapi=1&origin=http://example.com" frameborder="0"></iframe>

<script>
  function onYouTubeIframeAPIReady() {
	player = new YT.Player('player', {
	  events: {
		'onReady': onPlayerReady,
		'onStateChange': onPlayerStateChange,
		'onError': onError
	  }
	});
  }

  // 4. The API will call this function when the video player is ready.
  function onPlayerReady(event) {
	event.target.playVideo();
  }

  // 5. The API calls this function when the player's state changes.
  //    The function indicates that when playing a video (state=1),
  //    the player should play for six seconds and then stop.
  function onPlayerStateChange(event) {
	if (event.data == YT.PlayerState.ENDED) {
	  setTimeout(redirect, 1000);
	}
  }
  function onError(event) {
	setTimeout(redirect, 10000)
  }
  function redirect() {
	  location = "/{{id|add:"1"}}"
  }
</script>

<br>
<a href="/{% if id == "1" %}1{% else %}{{id|add:"-1"}}{% endif %}">Previous</a> <a href="/{{id|add:"1"}}">Next</a>
<br>
<a href="/add">Add video</a>

{% endtimezone %}
